(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11721,        271]
NotebookOptionsPosition[     10749,        247]
NotebookOutlinePosition[     11323,        265]
CellTagsIndexPosition[     11280,        262]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
   "rawdata", "=", 
    "\"\<08 02 22 97 38 15 00 40 00 75 04 05 07 78 52 12 50 77 91 08\n49 49 \
99 40 17 81 18 57 60 87 17 40 98 43 69 48 04 56 62 00\n81 49 31 73 55 79 14 \
29 93 71 40 67 53 88 30 03 49 13 36 65\n52 70 95 23 04 60 11 42 69 24 68 56 \
01 32 56 71 37 02 36 91\n22 31 16 71 51 67 63 89 41 92 36 54 22 40 40 28 66 \
33 13 80\n24 47 32 60 99 03 45 02 44 75 33 53 78 36 84 20 35 17 12 50\n32 98 \
81 28 64 23 67 10 26 38 40 67 59 54 70 66 18 38 64 70\n67 26 20 68 02 62 12 \
20 95 63 94 39 63 08 40 91 66 49 94 21\n24 55 58 05 66 73 99 26 97 17 78 78 \
96 83 14 88 34 89 63 72\n21 36 23 09 75 00 76 44 20 45 35 14 00 61 33 97 34 \
31 33 95\n78 17 53 28 22 75 31 67 15 94 03 80 04 62 16 14 09 53 56 92\n16 39 \
05 42 96 35 31 47 55 58 88 24 00 17 54 24 36 29 85 57\n86 56 00 48 35 71 89 \
07 05 44 44 37 44 60 21 58 51 54 17 58\n19 80 81 68 05 94 47 69 28 73 92 13 \
86 52 17 77 04 89 55 40\n04 52 08 83 97 35 99 16 07 97 57 32 16 26 26 79 33 \
27 98 66\n88 36 68 87 57 62 20 72 03 46 33 67 46 55 12 32 63 93 53 69\n04 42 \
16 73 38 25 39 11 24 94 72 18 08 46 29 32 40 62 76 36\n20 69 36 41 72 30 23 \
88 34 62 99 69 82 67 59 85 74 04 36 16\n20 73 35 29 78 31 90 01 74 31 49 71 \
48 86 81 16 23 57 05 54\n01 70 54 71 83 51 54 69 16 92 33 48 61 43 52 01 89 \
19 67 48\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrix", "=", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{
     RowBox[{"FromDigits", "/@", 
      RowBox[{"StringSplit", "[", "rawdata", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"20", ",", "20"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"blocklist", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{"matrix", ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Times", "@@@", "x"}], ",", 
      RowBox[{"Times", "@@@", 
       RowBox[{"Transpose", "@", "x"}]}], ",", 
      RowBox[{"Times", "@@", 
       RowBox[{"Diagonal", "@", "x"}]}], ",", 
      RowBox[{"Times", "@@", 
       RowBox[{"Diagonal", "@", 
        RowBox[{"Reverse", "@", 
         RowBox[{"Transpose", "@", "x"}]}]}]}]}], "}"}], "//", "Flatten"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Max", "[", 
  RowBox[{
   RowBox[{"f", "/@", 
    RowBox[{"Flatten", "[", 
     RowBox[{"blocklist", ",", "1"}], "]"}]}], "//", "Flatten"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.847346746801111*^9, 3.8473467468021083`*^9}, {
   3.8473468192576647`*^9, 3.8473468487083426`*^9}, {3.8473469112389293`*^9, 
   3.847346975505286*^9}, {3.8473470405394645`*^9, 3.847347060425603*^9}, {
   3.847348757549389*^9, 3.8473487592787037`*^9}, {3.847348797980074*^9, 
   3.847348820209488*^9}, {3.847348863097125*^9, 3.8473489060336437`*^9}, {
   3.8473489585237665`*^9, 3.8473489652236586`*^9}, 3.847349041669776*^9},
 CellLabel->"In[63]:=",ExpressionUUID->"fbe9cd0b-5d81-4a55-8f57-d878908074f9"],

Cell[BoxData["70600674"], "Output",
 CellChangeTimes->{{3.8473469525020795`*^9, 3.847346975823575*^9}, {
   3.8473470507591105`*^9, 3.8473470614116664`*^9}, {3.847348815574718*^9, 
   3.847348820527237*^9}, 3.84734887450941*^9, {3.84734891398662*^9, 
   3.847348916024064*^9}, {3.8473489594256797`*^9, 3.847348965507305*^9}, 
   3.847349042864043*^9},
 CellLabel->"Out[67]=",ExpressionUUID->"6c913d27-8655-4490-83ca-58af77afaff8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ArrayReshape", "[", 
  RowBox[{
   RowBox[{"FromDigits", "/@", 
    RowBox[{"StringSplit", "[", "rawdata", "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"20", ",", "20"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.847348762319644*^9, 3.847348782579441*^9}, {
  3.8473488230455675`*^9, 3.8473488965418863`*^9}, {3.8473489346275997`*^9, 
  3.8473489522984324`*^9}, {3.847348989684408*^9, 3.847348991849833*^9}, {
  3.84734903071986*^9, 3.8473490333355255`*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"106b0e41-fb3e-4bcd-983e-299cd49c6e56"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "8", ",", "2", ",", "22", ",", "97", ",", "38", ",", "15", ",", "0", ",", 
     "40", ",", "0", ",", "75", ",", "4", ",", "5", ",", "7", ",", "78", ",", 
     "52", ",", "12", ",", "50", ",", "77", ",", "91", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "49", ",", "49", ",", "99", ",", "40", ",", "17", ",", "81", ",", "18", 
     ",", "57", ",", "60", ",", "87", ",", "17", ",", "40", ",", "98", ",", 
     "43", ",", "69", ",", "48", ",", "4", ",", "56", ",", "62", ",", "0"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "81", ",", "49", ",", "31", ",", "73", ",", "55", ",", "79", ",", "14", 
     ",", "29", ",", "93", ",", "71", ",", "40", ",", "67", ",", "53", ",", 
     "88", ",", "30", ",", "3", ",", "49", ",", "13", ",", "36", ",", "65"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "52", ",", "70", ",", "95", ",", "23", ",", "4", ",", "60", ",", "11", 
     ",", "42", ",", "69", ",", "24", ",", "68", ",", "56", ",", "1", ",", 
     "32", ",", "56", ",", "71", ",", "37", ",", "2", ",", "36", ",", "91"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "22", ",", "31", ",", "16", ",", "71", ",", "51", ",", "67", ",", "63", 
     ",", "89", ",", "41", ",", "92", ",", "36", ",", "54", ",", "22", ",", 
     "40", ",", "40", ",", "28", ",", "66", ",", "33", ",", "13", ",", "80"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "24", ",", "47", ",", "32", ",", "60", ",", "99", ",", "3", ",", "45", 
     ",", "2", ",", "44", ",", "75", ",", "33", ",", "53", ",", "78", ",", 
     "36", ",", "84", ",", "20", ",", "35", ",", "17", ",", "12", ",", "50"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "32", ",", "98", ",", "81", ",", "28", ",", "64", ",", "23", ",", "67", 
     ",", "10", ",", "26", ",", "38", ",", "40", ",", "67", ",", "59", ",", 
     "54", ",", "70", ",", "66", ",", "18", ",", "38", ",", "64", ",", "70"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "67", ",", "26", ",", "20", ",", "68", ",", "2", ",", "62", ",", "12", 
     ",", "20", ",", "95", ",", "63", ",", "94", ",", "39", ",", "63", ",", 
     "8", ",", "40", ",", "91", ",", "66", ",", "49", ",", "94", ",", "21"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "24", ",", "55", ",", "58", ",", "5", ",", "66", ",", "73", ",", "99", 
     ",", "26", ",", "97", ",", "17", ",", "78", ",", "78", ",", "96", ",", 
     "83", ",", "14", ",", "88", ",", "34", ",", "89", ",", "63", ",", "72"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "21", ",", "36", ",", "23", ",", "9", ",", "75", ",", "0", ",", "76", ",",
      "44", ",", "20", ",", "45", ",", "35", ",", "14", ",", "0", ",", "61", 
     ",", "33", ",", "97", ",", "34", ",", "31", ",", "33", ",", "95"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "78", ",", "17", ",", "53", ",", "28", ",", "22", ",", "75", ",", "31", 
     ",", "67", ",", "15", ",", "94", ",", "3", ",", "80", ",", "4", ",", 
     "62", ",", "16", ",", "14", ",", "9", ",", "53", ",", "56", ",", "92"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "16", ",", "39", ",", "5", ",", "42", ",", "96", ",", "35", ",", "31", 
     ",", "47", ",", "55", ",", "58", ",", "88", ",", "24", ",", "0", ",", 
     "17", ",", "54", ",", "24", ",", "36", ",", "29", ",", "85", ",", "57"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "86", ",", "56", ",", "0", ",", "48", ",", "35", ",", "71", ",", "89", 
     ",", "7", ",", "5", ",", "44", ",", "44", ",", "37", ",", "44", ",", 
     "60", ",", "21", ",", "58", ",", "51", ",", "54", ",", "17", ",", "58"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "19", ",", "80", ",", "81", ",", "68", ",", "5", ",", "94", ",", "47", 
     ",", "69", ",", "28", ",", "73", ",", "92", ",", "13", ",", "86", ",", 
     "52", ",", "17", ",", "77", ",", "4", ",", "89", ",", "55", ",", "40"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4", ",", "52", ",", "8", ",", "83", ",", "97", ",", "35", ",", "99", ",",
      "16", ",", "7", ",", "97", ",", "57", ",", "32", ",", "16", ",", "26", 
     ",", "26", ",", "79", ",", "33", ",", "27", ",", "98", ",", "66"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "88", ",", "36", ",", "68", ",", "87", ",", "57", ",", "62", ",", "20", 
     ",", "72", ",", "3", ",", "46", ",", "33", ",", "67", ",", "46", ",", 
     "55", ",", "12", ",", "32", ",", "63", ",", "93", ",", "53", ",", "69"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4", ",", "42", ",", "16", ",", "73", ",", "38", ",", "25", ",", "39", 
     ",", "11", ",", "24", ",", "94", ",", "72", ",", "18", ",", "8", ",", 
     "46", ",", "29", ",", "32", ",", "40", ",", "62", ",", "76", ",", "36"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "20", ",", "69", ",", "36", ",", "41", ",", "72", ",", "30", ",", "23", 
     ",", "88", ",", "34", ",", "62", ",", "99", ",", "69", ",", "82", ",", 
     "67", ",", "59", ",", "85", ",", "74", ",", "4", ",", "36", ",", "16"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "20", ",", "73", ",", "35", ",", "29", ",", "78", ",", "31", ",", "90", 
     ",", "1", ",", "74", ",", "31", ",", "49", ",", "71", ",", "48", ",", 
     "86", ",", "81", ",", "16", ",", "23", ",", "57", ",", "5", ",", "54"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "70", ",", "54", ",", "71", ",", "83", ",", "51", ",", "54", 
     ",", "69", ",", "16", ",", "92", ",", "33", ",", "48", ",", "61", ",", 
     "43", ",", "52", ",", "1", ",", "89", ",", "19", ",", "67", ",", "48"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.847348826192175*^9, 3.847348896812172*^9}, 
   3.8473489527120647`*^9, 3.8473489921713*^9, {3.8473490311184916`*^9, 
   3.8473490336366596`*^9}},
 CellLabel->"Out[62]=",ExpressionUUID->"d765925e-a18b-406a-a90a-41048b6971c4"]
}, Open  ]],

Cell[BoxData["|"], "Input",
 CellChangeTimes->{
  3.847348857694846*^9},ExpressionUUID->"644d0ad9-3d95-488e-804b-\
6cd981959258"]
},
WindowSize->{1620, 586},
WindowMargins->{{Automatic, -102}, {143, Automatic}},
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (July 9, 2021)",
StyleDefinitions->FrontEnd`FileName[{$RootDirectory, "C:", "Users", "stary", 
   "AppData", "Roaming", "Mathematica", "SystemFiles", "FrontEnd", 
   "StyleSheets"}, "OD.nb", CharacterEncoding -> "UTF-8"],
ExpressionUUID->"5a731da5-8b19-4ca1-9d25-d39701225cde"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 3110, 66, 814, "Input",ExpressionUUID->"fbe9cd0b-5d81-4a55-8f57-d878908074f9"],
Cell[3693, 90, 430, 6, 42, "Output",ExpressionUUID->"6c913d27-8655-4490-83ca-58af77afaff8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4160, 101, 566, 11, 38, "Input",ExpressionUUID->"106b0e41-fb3e-4bcd-983e-299cd49c6e56"],
Cell[4729, 114, 5872, 125, 322, "Output",ExpressionUUID->"d765925e-a18b-406a-a90a-41048b6971c4"]
}, Open  ]],
Cell[10616, 242, 129, 3, 38, "Input",ExpressionUUID->"644d0ad9-3d95-488e-804b-6cd981959258"]
}
]
*)

